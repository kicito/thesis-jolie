\subsubsection{Type and Value Representation}
\label{sec:jolie-type-def}

The type system in Jolie is based on structural typing, where the compatibility and equivalence are determined from the actual structure of the comparing target. It is used to define the message's structure or send and receive messages. A type can be defined as a nested tree where each node contains a value. Jolie support common primitive types with an additional two build-in types \textbf{raw} and \textbf{any}. The \textbf{raw} type is an internal type used for passing data, and the programmer cannot create it. The \textbf{any} type indicates that the value can be in any form of the basic types. One of Jolie's data structure's key features is that every variable is storing as a dynamic array.

The type cardinality can be defined to ensure the range of occurrences for a node in the form of \textit{[ min, max ]} where min and max is a positive number indicates the range. The common quantifier shorthands such as ? and * also support here. If the cardinality is not defined, it will use the default value of [1,1]. As shown in the reference of \texttt{pet} field in listing ~\ref{list:TypeDefinitonUsage}. 

The syntax of Jolie type definition grammar is shown in ~\ref{fig:TypeDefinitonSyntax} where \(<ID>\) is a name defined for it's type structure.

A type can be defined in three ways:
\begin{itemize}
	\item \texttt{typeInline} is a structural composition of types, as illustrated in listing ~\ref{list:TypeDefinitonUsage}.
	\item \texttt{typeLink} is a definition aliasing to a previously defined type.
	\item \texttt{typeChoice} is a type that can be represent from multiple types.
\end{itemize}

\begin{figure}
	\begin{framed}
		\begin{grammar}
			<typeDefinition> ::= `type' <ID> `:' <type>

			<type> ::= <typeInline>
			\alt <typeLink>
			\alt <typeChoices>

			<typeChoices> ::= <type> `|' <type>

			<typeLink> ::= <ID>

			<typeInline> ::= <nativeType> <subTypeBlock>?

			<subTypeBlock> ::= `{' `.'? <ID> <cardinality>? `:' <type>? `}'

			<cardinality> ::= `[' int `,' ( int | `*' ) `]'
			\alt `*'
			\alt `?'

			<nativeType> ::= 'void' | 'string' | 'raw' | 'any' | 'int' | 'double' | 'long' | 'bool'
		\end{grammar}
	\end{framed}
	\caption{Jolie Type Definition Grammar\protect\footnotemark}
	\label{fig:TypeDefinitonSyntax}
\end{figure}

\footnotetext{ID denote an Identifier}

\begin{listing}
\begin{sublisting}{\linewidth}

\lstset{language=Jolie,
	style=codeStyle
}
\begin{lstlisting}[frame=tlrb, caption= {Constructing a type and value in Jolie}, label={list:type-value}]{typeDef-Jolie}
type person: int{
	name: void {
		firstname: string
		lastname: string
	}
	isMarried: bool
	pet[0, 2]: string
	age: int
}

person = 1
person.name.firstname = "John"
person.name.lastname = "Doe"
person.isMarried = false
person.pet = "Johnny"
person.pet[1] = "Max"
person.age = 20
\end{lstlisting}
\end{sublisting}\\[2ex]
\begin{sublisting}{\linewidth}
\lstset{language=XML,
showspaces=false
}
\begin{lstlisting}[frame=tlrb, caption= {XML representation of ~\ref{list:type-value}}, label={list:type-value-xml}]
<person>
	1
	<isMarried>false</isMarried>
	<name>
		<firstname>John</firstname>
		<lastname>Doe</lastname>
	</name>
	<pet>Johnny</pet>
	<pet>Max</pet>
	<age>20</age>
</person>
\end{lstlisting}
\end{sublisting}
\caption{ Jolie type Example }
\label{list:TypeDefinitonUsage}
\end{listing}

\FloatBarrier